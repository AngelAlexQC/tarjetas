# ========================================
# SonarCloud Configuration for Financiero
# React Native / Expo / TypeScript
# ========================================

# Identificación del proyecto
sonar.projectKey=AngelAlexQC_financiero
sonar.organization=angelalexqc
sonar.projectName=Financiero App
sonar.projectVersion=1.0.0

# ========================================
# Fuentes y Exclusiones
# ========================================

# Directorios con código fuente a analizar
sonar.sources=app,components,contexts,hooks,repositories,utils,constants,api

# Exclusiones globales (no analizar)
sonar.exclusions=\
  **/node_modules/**,\
  **/coverage/**,\
  **/.expo/**,\
  **/android/**,\
  **/ios/**,\
  **/dist/**,\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/__tests__/**,\
  **/__mocks__/**,\
  **/test-utils/**

# Archivos de test (para métricas de tests, no para bugs)
# IMPORTANTE: Mantener separados de sources para que no cuenten como código a testear
sonar.tests=.
sonar.test.inclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/__tests__/**

# ========================================
# Cobertura de código (Jest/LCOV)
# ========================================

# IMPORTANTE: sonar.javascript.lcov.reportPaths funciona para JS y TS
# sonar.typescript.lcov.reportPaths está DEPRECATED - NO usar
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# ========================================
# Configuración de lenguaje
# ========================================

sonar.sourceEncoding=UTF-8

# ========================================
# Quality Gate - Umbrales progresivos
# ========================================

# Cobertura: excluir archivos que no deben ser testeados
sonar.coverage.exclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/__tests__/**,\
  **/__mocks__/**,\
  **/test-utils/**,\
  **/*.d.ts,\
  **/types.ts,\
  **/index.ts,\
  **/index.tsx,\
  app/_layout.tsx,\
  app/+not-found.tsx,\
  constants/**

# Duplicación: máximo 3% de líneas duplicadas
sonar.cpd.exclusions=**/*.test.ts,**/*.test.tsx,**/__tests__/**

# Tamaño de archivo: advertir en archivos > 500 líneas
# (Los archivos muy grandes son difíciles de mantener)

# Complejidad ciclomática: máximo 15 por función
# (Funciones muy complejas son difíciles de testear)

# Extensiones de archivo a analizar
sonar.javascript.file.suffixes=.js,.jsx
sonar.typescript.file.suffixes=.ts,.tsx

# ========================================
# Ignorar Issues Específicos por Regla y Patrón
# ========================================

# Configuración para ignorar reglas específicas en archivos de tipo específico
# Formato: sonar.issue.ignore.multicriteria=KEY1,KEY2,KEY3...
# Para cada KEY:
#   sonar.issue.ignore.multicriteria.KEY.ruleKey = regla a ignorar
#   sonar.issue.ignore.multicriteria.KEY.resourceKey = patrón de archivos

sonar.issue.ignore.multicriteria=mock1,mock2,mock3,mock4,mock5,readonly1,ternary1,unusedprops1

# MOCK DATA: Ignorar Math.random() en archivos mock (S2245)
sonar.issue.ignore.multicriteria.mock1.ruleKey=typescript:S2245
sonar.issue.ignore.multicriteria.mock1.resourceKey=**/*mock*.ts

# MOCK DATA: Ignorar Math.random() en generadores de datos de prueba
sonar.issue.ignore.multicriteria.mock2.ruleKey=typescript:S2245
sonar.issue.ignore.multicriteria.mock2.resourceKey=**/insurance-generator.ts

# MOCK DATA: Ignorar Math.random() en pantallas de demo/prueba
sonar.issue.ignore.multicriteria.mock3.ruleKey=typescript:S2245
sonar.issue.ignore.multicriteria.mock3.resourceKey=app/cards/**/advance.tsx

sonar.issue.ignore.multicriteria.mock4.ruleKey=typescript:S2245
sonar.issue.ignore.multicriteria.mock4.resourceKey=app/cards/**/cardless-atm.tsx

sonar.issue.ignore.multicriteria.mock5.ruleKey=typescript:S2245
sonar.issue.ignore.multicriteria.mock5.resourceKey=app/cards/**/cvv.tsx

# Props readonly (S6759) - Esto puede ser muy estricto, considerar ignorarlo temporalmente
# Descomentar si quieres suprimir esta regla completamente:
# sonar.issue.ignore.multicriteria.readonly1.ruleKey=typescript:S6759
# sonar.issue.ignore.multicriteria.readonly1.resourceKey=**/*.tsx

# Ternarios anidados (S3358) - Se puede tolerar en algunos casos
# Descomentar si la complejidad es aceptable para tu equipo:
# sonar.issue.ignore.multicriteria.ternary1.ruleKey=typescript:S3358
# sonar.issue.ignore.multicriteria.ternary1.resourceKey=components/**/*.tsx

# Props no usadas (S6767) - Puede dar falsos positivos
# Descomentar si tienes props que se usan indirectamente:
# sonar.issue.ignore.multicriteria.unusedprops1.ruleKey=typescript:S6767
# sonar.issue.ignore.multicriteria.unusedprops1.resourceKey=**/*.tsx

# ========================================
# Quality Gate
# ========================================

# Esperar resultado del Quality Gate (falla el pipeline si no pasa)
sonar.qualitygate.wait=false

# ========================================
# Configuración de Issues
# ========================================

# Importar configuración avanzada de reglas
# Ver .sonarcloud.properties para detalles de reglas deshabilitadas
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,d1,d2,f1,f2,f3,f4,f5,f6

# Desactivar análisis de duplicación en archivos pequeños
# Solo reportar duplicación en archivos > 50 líneas
sonar.cpd.typescript.minimumLines=50
sonar.cpd.javascript.minimumLines=50

# ========================================
# Duplicaciones
# ========================================

# Exclusiones de análisis de código duplicado
sonar.cpd.exclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/__tests__/**
